(this["webpackJsonphive-ui"]=this["webpackJsonphive-ui"]||[]).push([[0],{100:function(e,t,n){e.exports=n(111)},105:function(e,t,n){},111:function(e,t,n){"use strict";n.r(t);var a,r,c=n(0),l=n.n(c),u=n(9),i=n.n(u),o=(n(105),n(23)),s=n(143),f=n(158),m=n(114),d=n(151),v=n(148),b=n(155),E=n(156);!function(e){e[e.SetParamValue=0]="SetParamValue",e[e.GetParamValue=1]="GetParamValue",e[e.GetEffects=2]="GetEffects",e[e.GetParams=3]="GetParams",e[e.GetClients=4]="GetClients"}(a||(a={})),function(e){e[e.Hue=0]="Hue",e[e.Saturation=1]="Saturation",e[e.Value=2]="Value",e[e.SpawnRate=3]="SpawnRate",e[e.Brightness=4]="Brightness",e[e.ActiveEffect=5]="ActiveEffect",e[e.NextFrameMs=6]="NextFrameMs",e[e.PaletteOffset=7]="PaletteOffset",e[e.SyncWithId=8]="SyncWithId",e[e.NumLeds=9]="NumLeds",e[e.HueRotationRate=10]="HueRotationRate"}(r||(r={}));var p=[{name:"None",value:255},{name:"Client 1",value:0},{name:"Client 2",value:1},{name:"Client 3",value:2},{name:"Client 4",value:3},{name:"Client 5",value:4},{name:"Client 6",value:5},{name:"Client 7",value:6},{name:"Client 8",value:7}],h={0:{name:"Hue",min:0,max:255,default:100},1:{name:"Saturation",min:0,max:255,default:255},2:{name:"Value",min:0,max:255,default:255},3:{name:"Spawn rate",min:0,max:255,default:150},4:{name:"Brightness",min:0,max:255,default:80},5:{name:"Active effect",min:0,max:6,default:0},6:{name:"Next frame (ms)",min:16,max:255,default:16},7:{name:"Palette offset",min:0,max:150,default:0},8:{name:"Sync with id",min:0,max:255,default:255},9:{name:"Num leds",min:72,max:72,default:72},10:{name:"Hue rotation rate",min:0,max:255,default:0}},O=[r.Brightness,r.HueRotationRate,r.SpawnRate,r.PaletteOffset,r.NextFrameMs],j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=new Uint8Array(5);return r[0]=e,r[1]=t,r[2]=n,r[3]=a,r[4]=a<<8,new Blob([r])},g=function(e){return Object.keys(e)[0]},y=function(e){return e[g(e)]},C=function(e){var t={};for(var n in e)t[n]=parseInt(e[n]);return t},w=n(86),k=n.n(w),S=n(85),V=n.n(S),x=n(18),I=n(19),N=n(167),R=n(162),W=n(164),D=n(166),P=n(145),G=n(159),H=n(149),A=n(76),B=n.n(A),z=n(77),L=n.n(z),T=Object(s.a)((function(e){return Object(R.a)({formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}})})),F=function(e){var t,n,a,c,u=T(),i=e.values,o=e.setValues,s=e.effects,m=i[r.ActiveEffect],d=function(e){o((function(t){return Object(I.a)(Object(I.a)({},t),{},Object(x.a)({},r.ActiveEffect,e))}))};return l.a.createElement("div",null,l.a.createElement(P.a,{className:u.formControl,fullWidth:!0},l.a.createElement(W.a,{id:"effect-select-label"},"Active effect"),l.a.createElement(G.a,{labelId:"effect-select-label",id:"effect-select",value:m,onChange:function(e){return d(parseInt(e.target.value))}},s.map((function(e){return l.a.createElement(D.a,{key:e.value,value:e.value},e.name)})))),l.a.createElement(f.a,{display:"flex"},l.a.createElement(H.a,{size:"small",color:"secondary",fullWidth:!0,onClick:function(){return d(m-1)},disabled:m<=0,startIcon:l.a.createElement(B.a,null)},null!==(t=null===(n=s[m-1])||void 0===n?void 0:n.name)&&void 0!==t?t:"None"),l.a.createElement(H.a,{size:"small",color:"secondary",fullWidth:!0,onClick:function(){return d(m+1)},disabled:m>=s.length-1,endIcon:l.a.createElement(L.a,null)},null!==(a=null===(c=s[m+1])||void 0===c?void 0:c.name)&&void 0!==a?a:"None")))},M=n(78),J=n(79),U=n.n(J),$=Object(s.a)((function(e){return Object(R.a)({formControl:{margin:e.spacing(1),minWidth:180},selectEmpty:{marginTop:e.spacing(2)}})})),q=function(e){var t=$(),n=e.values,a=e.setValues,u=e.connectedClients,i=n[r.SyncWithId],o=function(e){return 255===e||u.includes(e)},s=function(e){a((function(t){return Object(I.a)(Object(I.a)({},t),{},Object(x.a)({},r.SyncWithId,e))}))};return Object(c.useEffect)((function(){var e,t=Object(M.a)(u);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(i===n&&!o(n)){s(255);break}}}catch(a){t.e(a)}finally{t.f()}}),[u]),l.a.createElement(f.a,{display:"flex",justifyContent:"space-between",alignItems:"center"},l.a.createElement(P.a,{className:t.formControl,fullWidth:!0},l.a.createElement(W.a,{id:"sync-with-select-label"},"Sync with"),l.a.createElement(G.a,{labelId:"sync-with-select-label",id:"sync-with-select",value:i,onChange:function(e){return s(parseInt(e.target.value))}},p.map((function(t){return l.a.createElement(D.a,{key:t.value,value:t.value,disabled:t.value===e.clientId||!o(t.value)},t.name)})))),l.a.createElement("div",null,l.a.createElement(H.a,{onClick:function(){return s(255)},startIcon:l.a.createElement(U.a,null),variant:"contained",size:"small",color:"primary"},"Clear")))},K=n(88),Q=function(e,t,n){return Math.floor(e/t*n)},X=function(e){var t=Object(c.useRef)(null),n=Object(c.useRef)(0),a=Object(c.useRef)(null),u=e.values,i=e.setValues;return Object(c.useEffect)((function(){if(t.current){a.current=new K.a({appendTo:t.current,hsv:[0,100,100],wheelReflectsSaturation:!0,onChange:function(e){if(n.current){n.current=Date.now();var t=Q(e.hsv[0],360,255),a=Q(e.hsv[1],100,255),c=Q(e.hsv[2],100,255);i((function(e){var n;return Object(I.a)(Object(I.a)({},e),{},(n={},Object(x.a)(n,r.Hue,t),Object(x.a)(n,r.Saturation,a),Object(x.a)(n,r.Value,c),n))}))}else n.current=Date.now()}});var e=function(){a.current.wheelDiameter=Math.min(t.current.getBoundingClientRect().width,500),a.current.wheelThickness=a.current.wheelDiameter/500*40,a.current.handleDiameter=a.current.wheelDiameter/500*40,a.current.redraw()};e();var c=function(t){e()};return window.addEventListener("resize",c),function(){return window.removeEventListener("resize",c)}}}),[t]),Object(c.useEffect)((function(){if(a.current&&!(Date.now()-n.current<100)){var e=Q(u[r.Hue],255,360),t=Q(u[r.Saturation],255,100),c=Q(u[r.Value],255,100);a.current.hsv=[e,t,c]}}),[u]),l.a.createElement("div",{className:e.className,ref:t})},Y=Object(s.a)((function(e){return{colorWheel:{margin:e.spacing(2)}}})),Z=function(e){var t=Y(),n=e.clientId,a=e.values,r=e.setValues,c=e.effects;return l.a.createElement("div",null,l.a.createElement(F,{values:a,setValues:r,effects:c}),l.a.createElement(X,{values:a,setValues:r,className:t.colorWheel}),O.map((function(e){var t,n,c,u;return l.a.createElement(l.a.Fragment,{key:e},l.a.createElement(m.a,{variant:"subtitle2"},h[e].name),l.a.createElement(N.a,{onChange:function(t,n){return r((function(t){return Object(I.a)(Object(I.a)({},t),{},Object(x.a)({},e,n))}))},step:1,value:a[e],min:null!==(t=null===(n=h[e])||void 0===n?void 0:n.min)&&void 0!==t?t:0,max:null!==(c=null===(u=h[e])||void 0===u?void 0:u.max)&&void 0!==c?c:255,getAriaValueText:function(e){return e.toString()},valueLabelDisplay:"auto"}))})),l.a.createElement(q,{values:a,setValues:r,connectedClients:[0,1],clientId:n}))},_=n(84),ee=n.n(_),te=n(161),ne=n(154),ae=n(153),re=n(152),ce=n(150),le=n(15),ue=n(168),ie=function(e){var t=Object(le.a)(),n=Object(c.useState)(!1),a=Object(o.a)(n,2),u=a[0],i=a[1],s=Object(ce.a)(t.breakpoints.down("sm")),f=e.values,m=(e.setValues,function(){i(!1)});return l.a.createElement(l.a.Fragment,null,l.a.createElement(d.a,{onClick:function(){return i(!0)}},l.a.createElement(ee.a,null)),l.a.createElement(te.a,{fullScreen:s,open:u,onClose:m,"aria-labelledby":"responsive-dialog-title"},l.a.createElement(re.a,null,"Advanced settings"),l.a.createElement(ae.a,{dividers:!0},l.a.createElement(ue.a,{label:"Number of LED's",type:"number",variant:"filled",size:"small",defaultValue:f[r.NumLeds]}),l.a.createElement(ue.a,{label:"Client nickname",variant:"filled",size:"small",defaultValue:"Client"})),l.a.createElement(ne.a,null,l.a.createElement(H.a,{onClick:m,color:"primary",variant:"contained",autoFocus:!0},"Save"))))},oe=function(){var e=Object(c.useRef)(null),t=Object(c.useRef)(0),n=Object(c.useRef)(null),a=Object(c.useCallback)((function(a,r){n.current=a;var c=function(){n.current(),t.current=Date.now()};Date.now()-t.current>r?c():e.current||(e.current=setTimeout((function(){e.current=null,c()}),r))}),[e]);return Object(c.useEffect)((function(){return function(){return clearTimeout(e.current)}}),[e]),a},se=n(163),fe=Object.keys(h).reduce((function(e,t){return e[t]=h[t].default,e}),{}),me=function(e){var t=oe(),n=Object(c.useState)(!1),r=Object(o.a)(n,2),u=r[0],i=r[1],s=Object(c.useState)(fe),p=Object(o.a)(s,2),h=p[0],O=p[1],g=Object(c.useRef)(fe),y=e.isConnected,C=e.isSocketOpen,w=e.id,S=e.socket,x=e.effects,I=function(){return Object.keys(h).filter((function(e){return function(e){return g.current[e]!==h[e]}(e)}))};Object(c.useEffect)((function(){C&&y&&t((function(){I().forEach((function(e){!function(e){g.current[e]=h[e]}(e);var t=j(a.SetParamValue,w,parseInt(e),h[e]);S.send(t)}))}),20)}),[h,C,w,S]),Object(c.useEffect)((function(){Object.keys(e.params).length&&(O(e.params),g.current=e.params)}),[e.params]),Object(c.useEffect)((function(){y&&C&&S.send(j(a.GetParams,w))}),[y,C,S]);return l.a.createElement(v.a,null,l.a.createElement(f.a,{padding:2},l.a.createElement(f.a,{display:"flex",justifyContent:"space-between",alignItems:"center"},l.a.createElement("div",null,l.a.createElement(m.a,{variant:"h6"},"Client ",w+1),l.a.createElement(m.a,{variant:"subtitle2"},y?"Connected":"Disconnected"),l.a.createElement(d.a,{onClick:function(){y&&C&&S.send(j(a.GetParams,w))},disabled:!y},l.a.createElement(se.a,null))),l.a.createElement(b.a,{color:"secondary",size:"small",disabled:!y,onClick:function(){return i((function(e){return!e}))}},u?l.a.createElement(V.a,null):l.a.createElement(k.a,null))),l.a.createElement(E.a,{in:u},l.a.createElement(Z,{clientId:w,values:h,setValues:O,effects:x})),l.a.createElement(ie,{values:h,setValues:O})))},de=function(e){return Object(c.useRef)(new WebSocket(e)).current},ve=Object(s.a)((function(e){return{root:{height:"100%",minHeight:"100vh",backgroundColor:e.palette.background.default}}})),be=function(){var e=ve(),t=Object(c.useState)([]),n=Object(o.a)(t,2),r=n[0],u=n[1],i=Object(c.useState)([{},{},{},{},{},{},{},{}]),s=Object(o.a)(i,2),v=s[0],b=s[1],E=Object(c.useState)(),p=Object(o.a)(E,2),h=p[0],O=p[1],w=Object(c.useState)(!1),k=Object(o.a)(w,2),S=k[0],V=k[1],x=de("ws://192.168.1.200:81");x.onclose=function(e){console.log("disconnected"),V(!1)},x.onopen=function(e){console.log("connected"),V(!0)},x.onmessage=function(e){if("string"===typeof e.data&&e.data.startsWith("{")){var t=JSON.parse(e.data),n=g(t);if(console.log(e.data),n.includes("params")){var a=function(e){return g(e).split("@")[1]}(t),r=C(y(t));console.log(r),b((function(e){return e.map((function(e,t){return t===+a?r:e}))}))}if(n.includes("effects")&&u(function(e,t){return Object.keys(e[t]).map((function(n){return{name:e[t][n],value:+n}}))}(t,"effects")),n.includes("clients")){var c=C(y(t));O(c)}}};var I=function(){S&&(x.send(j(a.GetClients)),x.send(j(a.GetEffects)))};return Object(c.useEffect)((function(){I()}),[S,x]),l.a.createElement("div",{className:e.root},l.a.createElement(f.a,{paddingTop:2,paddingLeft:2},l.a.createElement(m.a,{variant:"subtitle2",color:S?"secondary":"primary"},S?"Connected":"Disconnected"),l.a.createElement(d.a,{onClick:I,disabled:!S},l.a.createElement(se.a,null))),[0,1,2,3,4,5,6,7].map((function(e){return l.a.createElement(f.a,{key:e,padding:2},l.a.createElement(me,{id:e,socket:x,isSocketOpen:S,isConnected:Boolean(null===h||void 0===h?void 0:h[e]),effects:r,params:v[e]}))})))},Ee=n(157),pe=n(87),he=Object(pe.a)({palette:{type:"dark",primary:{main:"#512da8"},secondary:{main:"#1de9b6"},background:{default:"#0f1724",paper:"#1d2636"}}}),Oe=function(){return l.a.createElement(Ee.a,{theme:he},l.a.createElement(be,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(Oe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[100,1,2]]]);
//# sourceMappingURL=main.c2005347.chunk.js.map